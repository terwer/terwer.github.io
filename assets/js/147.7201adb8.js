(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{502:function(s,a,t){"use strict";t.r(a);var e=t(8),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"deepin20-5-安装-docker-与-docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deepin20-5-安装-docker-与-docker-compose"}},[s._v("#")]),s._v(" Deepin20.5 安装 docker 与 docker-compose")]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("文章更新历史")])]),s._v(" "),a("p",[s._v("2022/06/14 fix:统信UOS 21.3家庭版验证通过。")]),s._v(" "),a("p",[s._v("2022/05/29 fix:Deepin 20.6也验证通过。")])]),s._v(" "),a("h2",{attrs:{id:"卸载旧版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#卸载旧版本"}},[s._v("#")]),s._v(" 卸载旧版本")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" remove docker.io docker-engine\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"安装秘钥管理工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装秘钥管理工具"}},[s._v("#")]),s._v(" 安装秘钥管理工具")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" software-properties-common\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" apt-transport-https ca-certificates "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("为了确认所下载软件包的合法性，需要添加软件源的 GPG 密钥。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("// 中科大源\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" https://mirrors.ustc.edu.cn/docker-ce/linux/debian/gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n\n// 官方源，能否成功可能需要看运气。\n// "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" https://download.docker.com/linux/debian/gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("查看密钥是否安装成功")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key fingerprint 0EBFCD88\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"添加-docker-源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加-docker-源"}},[s._v("#")]),s._v(" 添加 docker 源")]),s._v(" "),a("p",[a("s",[s._v("方法一：直接修改文件（已废弃）")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里我们通过编辑 sudo vim /etc/apt/sources.list 添加一行即可，原因未知")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/debian buster stable")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("方法二：新建镜像源文件（推荐）")])]),s._v(" "),a("p",[s._v("方法一是直接修改镜像原文件，显得不那么优雅。最好是在 "),a("code",[s._v("/etc/apt/sources.list.d")]),s._v(" 目录新建一个 .list 文件，然后写上源地址即可。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/apt/sources.list.d\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" docker.list\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("内容如下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("deb "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amd64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" https://mirrors.ustc.edu.cn/docker-ce/linux/debian buster stable\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://ghproxy.com/https://raw.githubusercontent.com/terwer/upload/main/img/20220614205016.png",alt:"image-20220614204804619"}})]),s._v(" "),a("h2",{attrs:{id:"安装-docker-以及-docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-docker-以及-docker-compose"}},[s._v("#")]),s._v(" 安装 docker 以及 docker-compose")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io docker-compose-plugin "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"让普通用户也可运行-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#让普通用户也可运行-docker"}},[s._v("#")]),s._v(" 让普通用户也可运行 docker")]),s._v(" "),a("p",[s._v("运行 "),a("code",[s._v("docker ps")]),s._v(" 如果显示权限不足，那是是因为 docker 只允许 root 用户执行。为让普通用户也可运行 docker，执行")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" username\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将当前用户加入 docker 用户组，然后"),a("strong",[s._v("注销用户重新登录")]),s._v("即可。")]),s._v(" "),a("p",[a("strong",[s._v("注意：一定要注销登录、一定要注销登录、一定要注销登录。")])]),s._v(" "),a("p",[s._v("否则权限无法生效，普通用户使用 "),a("code",[s._v("docker ps")]),s._v(" 无法查看 docker 状态。")]),s._v(" "),a("h2",{attrs:{id:"启动-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-docker"}},[s._v("#")]),s._v(" 启动 docker")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"测试安装效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试安装效果"}},[s._v("#")]),s._v(" 测试安装效果")]),s._v(" "),a("p",[s._v("可以通过 "),a("code",[s._v("hello-world")]),s._v(" 镜像来验证.")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("注意：如果不想重启，可以暂时使用sudo来看：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://ghproxy.com/https://raw.githubusercontent.com/terwer/upload/main/img/20220614212009.png",alt:"image-20220614212007264"}})]),s._v(" "),a("h2",{attrs:{id:"延伸阅读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#延伸阅读"}},[s._v("#")]),s._v(" 延伸阅读")]),s._v(" "),a("h3",{attrs:{id:"查看可安装的所有版本列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看可安装的所有版本列表"}},[s._v("#")]),s._v(" 查看可安装的所有版本列表")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("➜  ~ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-cache")]),s._v(" madison docker-ce\n docker-ce "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(":20.10.16~3-0~debian-buster "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" https://mirrors.ustc.edu.cn/docker-ce/linux/debian buster/stable amd64 Packages\n docker-ce "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(":20.10.15~3-0~debian-buster "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" https://mirrors.ustc.edu.cn/docker-ce/linux/debian buster/stable amd64 Packages\n docker-ce "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(":20.10.14~3-0~debian-buster "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" https://mirrors.ustc.edu.cn/docker-ce/linux/debian buster/stable amd64 Packages\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"安装指定版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装指定版本"}},[s._v("#")]),s._v(" 安装指定版本")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VERSION_STRING"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" docker-ce-cli"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VERSION_STRING"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" containerd.io docker-compose-plugin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"禁止开机自启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁止开机自启"}},[s._v("#")]),s._v(" 禁止开机自启")]),s._v(" "),a("p",[s._v("默认情况下 docker 是开机自启的，如果我们想禁用开机自启，可以通过安装 chkconfig 命令来管理 Deepin 自启项：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("安装 chkconfig")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("移除自启")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--del")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])])])}),[],!1,null,null,null);a.default=r.exports}}]);