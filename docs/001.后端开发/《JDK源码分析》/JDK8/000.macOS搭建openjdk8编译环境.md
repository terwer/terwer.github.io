---
title: 000.macOS搭建openjdk8编译环境
date: '2023-09-19 10:20:28'
meta:
  - name: keywords
    content: macos openjdk 编译环境 源码 配置
  - name: description
    content: >-
      本文介绍了在macOS上搭建OpenJDK编译环境的准备步骤，包括安装必要的软件和拉取OpenJDK源码。文章还简要介绍了OpenJDK源码的目录结构，以及各个子目录的作用，包括HotSpot虚拟机、LangTools开发工具、JDK运行时库等。此外，还提到了与XML处理、Web服务和JavaScript引擎相关的组件，以及安装CCache以加速编译的必要性。最后，文章列出了可配置的参数和选项，以帮助读者进行更精细的配置。
tags:
  - macos
  - openjdk
  - 编译环境
  - 源码
  - 配置
categories:
  - 后端开发
  - 《JDK源码分析》
  - JDK8
permalink: /post/000-macos-builds-an-openjdk8-compilation-environment-2tjnwn.html
author:
  name: terwer
  link: https://github.com/terwer
---
本文介绍了在macOS上搭建OpenJDK编译环境的准备步骤，包括安装必要的软件和拉取OpenJDK源码。文章还简要介绍了OpenJDK源码的目录结构，以及各个子目录的作用，包括HotSpot虚拟机、LangTools开发工具、JDK运行时库等。此外，还提到了与XML处理、Web服务和JavaScript引擎相关的组件，以及安装CCache以加速编译的必要性。最后，文章列出了可配置的参数和选项，以帮助读者进行更精细的配置。

<!-- more -->


# 000.macOS搭建openjdk8编译环境

## 环境准备

* macOS Ventura 13.5.2
* freetype （可使用 `brew install freetype`​ 安装）
* jdk1.8.0_333
* [XQuartz](https://www.xquartz.org/) XQuartz 2.7.11（xorg-server 1.18.4）
* gawk（可使用 `brew install gawk`​ 安装）

## 拉取 openjdk8 源码

```bash
git clone https://github.com/openjdk/jdk8u jdk8u
```

代码的目录结构如下

|目录<br />||
|.|通用配置和生成 `makefile` ​编译文件，`configure`​、`MakeFile`​。|
| :-------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|hotspot|用于构建 `OpenJDK`​ 虚拟机的源代码和 `make` ​文件，也就是 `JVM` ​源码，目录结构后面会介绍。|
|langtools|​`JDK` ​提供的开发工具，比如 `javac`​、`javap` ​等工具，目录结构后面会介绍。|
|jdk|​`JDK` ​的源码和用于构建 OpenJDK 运行时库和杂项的 make 文件，目录结构后面会介绍。|
|jaxp|​`JAXP` ​的全称是 Java API for XML Processing，是 `Java` ​定义的一组操作 `XML` ​文档的 API，注意 `JAXP` ​只是定义了 API，并没有提供具体的实现，`Java` ​为了保证 `JAXP` ​能够即装即用，默认带了 Apache Xerces 解析器，代码位于 `jaxp/src/com/sun/org/apache` ​下。目录结构后面会介绍。|
|jaxws|JAX-WS 全称是 JavaTM API forXML-Based Web Services, 是一组基于 SOAP 协议实现的 `Web Service` ​的 API，与之相对的是 JAX-RS，全称是 JavaTM API for RESTful Webservices，是一组基于 RESTful 风格的 Http 服务实现 `Web Service` ​的 API。JAF 全称是 JavaBeans Activation Framework， JAF 的目的在于统一处理不同数据格式的方法（不管数据格式为简单文本还是由图片、声音、视频甚至其它"活动"内容共同组成的复合文档），使得 `Java` ​对象与编码数据流之间的映射变得非常容易，可以参考 `JavaMail` ​中 JAF 的应用。JAX-WS 相关代码位于 `jaxws/src/share/jaxws_classes`​，目录结构后面会介绍。|
|nashorn|​`JDK8` ​内嵌的 Nashorn JavaScript 引擎，扩展了 `Java` ​在 `JVM` ​上运行动态 `JavaScript` ​脚本的能力。|
|corba|​`CORBA`​ 全称是 Common Object Request Broker Architecture，CORBA 1.1 由对象管理组织在 1991 年发布，他定义了接口定义语言（IDL）和应用编程接口（API），从而通过实现对象请求代理（ORB）来激活客户/服务器的交互。CORBA 2.0 于 1994 年的 12 月发布，他定义了如何跨越不同的 ORB 提供者而进行通讯。在功能上基本等同于 `Web Service`​。它实现了分布式系统下跨平台，跨语言的数据的传输和远程方法的本地调用。|

## 安装 ccache 加速编译

必须大于 3，我目前是 `4.8.3`​

```bash
brew install ccache
```

## 检测

* 参数的意思在上面的配置文件里有部分解释，也可以通过 `sh ./configure --help`​​ 查看字段意义，也可能看官网的解释：[http://hg.openjdk.java.net/jdk8u/jdk8u/raw-file/tip/README-builds.html#configure](http://hg.openjdk.java.net/jdk8u/jdk8u/raw-file/tip/README-builds.html#configure)
* ```
  sh ./configure --help
  ```

可配置参数如下

```
➜  jdk8u git:(master) ✗ sh ./configure --help

Running generated-configure.sh
`configure' configures OpenJDK jdk8 to adapt to many kinds of systems.

Usage: /Users/terwer/Documents/code/jdk/jdk8u/configure [OPTION]... [VAR=VALUE]...

To assign environment variables (e.g., CC, CFLAGS...), specify them as
VAR=VALUE.  See below for descriptions of some of the useful variables.

Defaults for the options are specified in brackets.

Configuration:
  -h, --help              display this help and exit
      --help=short        display options specific to this package
      --help=recursive    display the short help of all the included packages
  -V, --version           display version information and exit
  -q, --quiet, --silent   do not print `checking ...' messages
      --cache-file=FILE   cache test results in FILE [disabled]
  -C, --config-cache      alias for `--cache-file=config.cache'
  -n, --no-create         do not create output files
      --srcdir=DIR        find the sources in DIR [configure dir or `..']

Installation directories:
  --prefix=PREFIX         install architecture-independent files in PREFIX
                          [/usr/local]
  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
                          [PREFIX]

By default, `make install' will install all the files in
`/usr/local/bin', `/usr/local/lib' etc.  You can specify
an installation prefix other than `/usr/local' using `--prefix',
for instance `--prefix=$HOME'.

For better control, use the options below.

Fine tuning of the installation directories:
  --bindir=DIR            user executables [EPREFIX/bin]
  --sbindir=DIR           system admin executables [EPREFIX/sbin]
  --libexecdir=DIR        program executables [EPREFIX/libexec]
  --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
  --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
  --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
  --runstatedir=DIR       modifiable per-process data [LOCALSTATEDIR/run]
  --libdir=DIR            object code libraries [EPREFIX/lib]
  --includedir=DIR        C header files [PREFIX/include]
  --oldincludedir=DIR     C header files for non-gcc [/usr/include]
  --datarootdir=DIR       read-only arch.-independent data root [PREFIX/share]
  --datadir=DIR           read-only architecture-independent data [DATAROOTDIR]
  --infodir=DIR           info documentation [DATAROOTDIR/info]
  --localedir=DIR         locale-dependent data [DATAROOTDIR/locale]
  --mandir=DIR            man documentation [DATAROOTDIR/man]
  --docdir=DIR            documentation root [DATAROOTDIR/doc/openjdk]
  --htmldir=DIR           html documentation [DOCDIR]
  --dvidir=DIR            dvi documentation [DOCDIR]
  --pdfdir=DIR            pdf documentation [DOCDIR]
  --psdir=DIR             ps documentation [DOCDIR]

X features:
  --x-includes=DIR    X include files are in DIR
  --x-libraries=DIR   X library files are in DIR

System types:
  --build=BUILD     configure for building on BUILD [guessed]
  --host=HOST       cross-compile to build programs to run on HOST [BUILD]
  --target=TARGET   configure for building compilers for TARGET [HOST]

Optional Features:
  --disable-option-checking  ignore unrecognized --enable/--with options
  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
  --enable-openjdk-only   suppress building custom source even if present
                          [disabled]
  --enable-debug          set the debug level to fastdebug (shorthand for
                          --with-debug-level=fastdebug) [disabled]
  --disable-headful       disable building headful support (graphical UI
                          support) [enabled]
  --enable-hotspot-test-in-build
                          run the Queens test after Hotspot build [disabled]
  --enable-unlimited-crypto
                          Enable unlimited crypto policy [disabled]
  --disable-jfr           Disable Java Flight Recorder support [enabled]
  --disable-debug-symbols disable generation of debug symbols [enabled]
  --disable-zip-debug-info
                          disable zipping of debug-info files [enabled]
  --enable-macosx-runtime-support
                          Deprecated. Option is kept for backwards
                          compatibility and is ignored
  --disable-freetype-bundling
                          disable bundling of the freetype library with the
                          build result [enabled on Windows or when using
                          --with-freetype, disabled otherwise]
  --enable-sjavac         use sjavac to do fast incremental compiles
                          [disabled]
  --disable-precompiled-headers
                          disable using precompiled headers when compiling C++
                          [enabled]
  --enable-ccache         enable using ccache to speed up recompilations
                          [disabled]

Optional Packages:
  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
  --with-custom-make-dir  use this directory for custom build/make files
  --with-target-bits      build 32-bit or 64-bit binaries (for platforms that
                          support it), e.g. --with-target-bits=32 [guessed]
  --with-jdk-variant      JDK variant to build (normal) [normal]
  --with-jvm-interpreter  JVM interpreter to build (template, cpp) [template]
  --with-jvm-variants     JVM variants (separated by commas) to build (server,
                          client, minimal1, kernel, zero, zeroshark, core)
                          [server]
  --with-debug-level      set the debug level (release, fastdebug, slowdebug)
                          [release]
  --with-devkit           use this devkit for compilers, tools and resources
  --with-sys-root         alias for --with-sysroot for backwards compatability
  --with-sysroot          use this directory as sysroot)
  --with-tools-dir        alias for --with-toolchain-path for backwards
                          compatibility
  --with-toolchain-path   prepend these directories when searching for
                          toolchain binaries (compilers etc)
  --with-extra-path       prepend these directories to the default path
  --with-xcode-path       explicit path to Xcode application (generally for
                          building on 10.9 and later)
  --with-conf-name        use this as the name of the configuration [generated
                          from important configuration options]
  --with-builddeps-conf   use this configuration file for the builddeps
  --with-builddeps-server download and use build dependencies from this server
                          url
  --with-builddeps-dir    store downloaded build dependencies here
                          [/localhome/builddeps]
  --with-builddeps-group  chgrp the downloaded build dependencies to this
                          group
  --with-cacerts-file     specify alternative cacerts file
  --with-milestone        Set milestone value for build [internal]
  --with-update-version   Set update version value for build [b00]
  --with-user-release-suffix
                          Add a custom string to the version string if build
                          number isn't set.[username_builddateb00]
  --with-build-number     Set build number value for build [b00]
  --with-vendor-name      Set vendor name. Among others, used to set the
                          'java.vendor' and 'java.vm.vendor' system
                          properties. [not specified]
  --with-vendor-url       Set the 'java.vendor.url' system property [not
                          specified]
  --with-vendor-bug-url   Set the 'java.vendor.url.bug' system property [not
                          specified]
  --with-vendor-vm-bug-url
                          Sets the bug URL which will be displayed when the VM
                          crashes [not specified]
  --with-copyright-year   Set copyright year value for build [current year]
  --with-boot-jdk         path to Boot JDK (used to bootstrap build) [probed]
  --with-boot-jdk-jvmargs specify JVM arguments to be passed to all
                          invocations of the Boot JDK, overriding the default
                          values, e.g --with-boot-jdk-jvmargs="-Xmx8G
                          -enableassertions"
  --with-add-source-root  for each and every source directory, look in this
                          additional source root for the same directory; if it
                          exists and have files in it, include it in the build
  --with-override-source-root
                          for each and every source directory, look in this
                          override source root for the same directory; if it
                          exists, use that directory instead and ignore the
                          directory in the original source root
  --with-adds-and-overrides
                          use the subdirs 'adds' and 'overrides' in the
                          specified directory as add-source-root and
                          override-source-root
  --with-override-langtools
                          use this langtools dir for the build
  --with-override-corba   use this corba dir for the build
  --with-override-jaxp    use this jaxp dir for the build
  --with-override-jaxws   use this jaxws dir for the build
  --with-override-hotspot use this hotspot dir for the build
  --with-override-nashorn use this nashorn dir for the build
  --with-override-jdk     use this jdk dir for the build
  --with-import-hotspot   import hotspot binaries from this jdk image or
                          hotspot build dist dir instead of building from
                          source
  --with-toolchain-type   the toolchain type (or family) to use, use '--help'
                          to show possible values [platform dependent]
  --with-toolchain-version
                          the version of the toolchain to look for, use
                          '--help' to show possible values [platform
                          dependent]
  --with-jtreg            Regression Test Harness [probed]
  --with-extra-cflags     extra flags to be used when compiling jdk c-files
  --with-extra-cxxflags   extra flags to be used when compiling jdk c++-files
  --with-extra-ldflags    extra flags to be used when linking jdk
  --with-extra-asflags    extra flags to be passed to the assembler
  --with-native-debug-symbols
                          set the native debug symbol configuration (none,
                          internal, external, zipped) [varying]
  --with-x                use the X Window System
  --with-cups             specify prefix directory for the cups package
                          (expecting the headers under PATH/include)
  --with-cups-include     specify directory for the cups include files
  --with-freetype         specify prefix directory for the freetype package
                          (expecting the libraries under PATH/lib and the
                          headers under PATH/include)
  --with-freetype-include specify directory for the freetype include files
  --with-freetype-lib     specify directory for the freetype library
  --with-freetype-src     specify directory with freetype sources to
                          automatically build the library (experimental,
                          Windows-only)
  --with-alsa             specify prefix directory for the alsa package
                          (expecting the libraries under PATH/lib and the
                          headers under PATH/include)
  --with-alsa-include     specify directory for the alsa include files
  --with-alsa-lib         specify directory for the alsa library
  --with-fontconfig       specify prefix directory for the fontconfig package
                          (expecting the headers under PATH/include)
  --with-fontconfig-include
                          specify directory for the fontconfig include files
  --with-giflib           use giflib from build system or OpenJDK source
                          (system, bundled) [bundled]
  --with-zlib             use zlib from build system or OpenJDK source
                          (system, bundled) [bundled]
  --with-stdc++lib=<static>,<dynamic>,<default>
                          force linking of the C++ runtime on Linux to either
                          static or dynamic, default is static with dynamic as
                          fallback
  --with-msvcr-dll        path to microsoft C runtime dll (msvcr*.dll)
                          (Windows only) [probed]
  --with-msvcp-dll        path to microsoft C++ runtime dll (msvcp*.dll)
                          (Windows only) [probed]
  --with-vcruntime-1-dll  path to microsoft C++ runtime dll (vcruntime*_1.dll)
                          (Windows only) [probed]
  --with-ucrt-dll-dir     path to Microsoft Windows Kit UCRT DLL dir (Windows
                          only) [probed]
  --with-dxsdk            Deprecated. Option is kept for backwards
                          compatibility and is ignored
  --with-dxsdk-lib        Deprecated. Option is kept for backwards
                          compatibility and is ignored
  --with-dxsdk-include    Deprecated. Option is kept for backwards
                          compatibility and is ignored
  --with-num-cores        number of cores in the build system, e.g.
                          --with-num-cores=8 [probed]
  --with-memory-size      memory (in MB) available in the build system, e.g.
                          --with-memory-size=1024 [probed]
  --with-jobs             number of parallel jobs to let make run [calculated
                          based on cores and memory]
  --with-sjavac-server-java
                          use this java binary for running the sjavac
                          background server [Boot JDK java]
  --with-ccache-dir       where to store ccache files [~/.ccache]

Some influential environment variables:
  BASENAME    Override default value for BASENAME
  BASH        Override default value for BASH
  CAT         Override default value for CAT
  CHMOD       Override default value for CHMOD
  CMP         Override default value for CMP
  COMM        Override default value for COMM
  CP          Override default value for CP
  CUT         Override default value for CUT
  DATE        Override default value for DATE
  DIFF        Override default value for DIFF
  DIRNAME     Override default value for DIRNAME
  ECHO        Override default value for ECHO
  EXPR        Override default value for EXPR
  FILE        Override default value for FILE
  FIND        Override default value for FIND
  HEAD        Override default value for HEAD
  LN          Override default value for LN
  LS          Override default value for LS
  MKDIR       Override default value for MKDIR
  MKTEMP      Override default value for MKTEMP
  MV          Override default value for MV
  NAWK        Override default value for NAWK
  PRINTF      Override default value for PRINTF
  RM          Override default value for RM
  SH          Override default value for SH
  SORT        Override default value for SORT
  TAIL        Override default value for TAIL
  TAR         Override default value for TAR
  TEE         Override default value for TEE
  TOUCH       Override default value for TOUCH
  TR          Override default value for TR
  UNAME       Override default value for UNAME
  UNIQ        Override default value for UNIQ
  WC          Override default value for WC
  WHICH       Override default value for WHICH
  XARGS       Override default value for XARGS
  AWK         Override default value for AWK
  GREP        Override default value for GREP
  EGREP       Override default value for EGREP
  FGREP       Override default value for FGREP
  SED         Override default value for SED
  CYGPATH     Override default value for CYGPATH
  READLINK    Override default value for READLINK
  DF          Override default value for DF
  SETFILE     Override default value for SETFILE
  CPIO        Override default value for CPIO
  UNZIP       Override default value for UNZIP
  ZIP         Override default value for ZIP
  LDD         Override default value for LDD
  READELF     Override default value for READELF
  HG          Override default value for HG
  GIT         Override default value for GIT
  STAT        Override default value for STAT
  TIME        Override default value for TIME
  DSYMUTIL    Override default value for DSYMUTIL
  XATTR       Override default value for XATTR
  CODESIGN    Override default value for CODESIGN
  PKG_CONFIG  path to pkg-config utility
  CC          C compiler command
  CFLAGS      C compiler flags
  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
              nonstandard directory <lib dir>
  LIBS        libraries to pass to the linker, e.g. -l<library>
  CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if
              you have headers in a nonstandard directory <include dir>
  CXX         C++ compiler command
  CXXFLAGS    C++ compiler flags
  CPP         C preprocessor
  CXXCPP      C++ preprocessor
  AS          Override default value for AS
  AR          Override default value for AR
  OBJC        Objective C compiler command
  OBJCFLAGS   Objective C compiler flags
  LIPO        Override default value for LIPO
  STRIP       Override default value for STRIP
  NM          Override default value for NM
  GNM         Override default value for GNM
  MCS         Override default value for MCS
  OBJCOPY     Override default value for OBJCOPY
  OBJDUMP     Override default value for OBJDUMP
  BUILD_CC    Override default value for BUILD_CC
  BUILD_CXX   Override default value for BUILD_CXX
  BUILD_LD    Override default value for BUILD_LD
  JTREGEXE    Override default value for JTREGEXE
  XMKMF       Path to xmkmf, Makefile generator for X Window System
  FREETYPE_CFLAGS
              C compiler flags for FREETYPE, overriding pkg-config
  FREETYPE_LIBS
              linker flags for FREETYPE, overriding pkg-config
  ALSA_CFLAGS C compiler flags for ALSA, overriding pkg-config
  ALSA_LIBS   linker flags for ALSA, overriding pkg-config
  LIBFFI_CFLAGS
              C compiler flags for LIBFFI, overriding pkg-config
  LIBFFI_LIBS linker flags for LIBFFI, overriding pkg-config
  CCACHE      Override default value for CCACHE

Use these variables to override the choices made by `configure' or to help
it to find libraries and programs with nonstandard names/locations.

Report bugs to <build-dev@openjdk.java.net>.
OpenJDK home page: <http://openjdk.java.net>.

Additional (non-autoconf) OpenJDK Options:
  --openjdk-target=TARGET cross-compile with TARGET as target platform
                          (i.e. the one you will run the resulting binary on).
                          Equivalent to --host=TARGET --target=TARGET
                          --build=<current platform>
  --debug-configure       Run the configure script with additional debug
                          logging enabled.

The following toolchains are available as arguments to --with-toolchain-type.
Which are valid to use depends on the build platform.
  gcc         GNU Compiler Collection
  clang       clang/LLVM
  solstudio   Oracle Solaris Studio
  xlc         IBM XL C/C++
  microsoft   Microsoft Visual Studio

Please be aware that, when cross-compiling, the OpenJDK configure script will
generally use 'target' where autoconf traditionally uses 'host'.

Also note that variables must be passed on the command line. Variables in the
environment will generally be ignored, unlike traditional autoconf scripts.
➜  jdk8u git:(master) ✗ 
```

最终的检测命令

```
sh ./configure --with-xcode-path=/Applications/Xcode_12.4.app \
--with-boot-jdk=/Library/Java/JavaVirtualMachines/jdk1.8.0_333.jdk/Contents/Home \
--with-freetype-include=/usr/local/include/freetype2 \
--with-freetype-lib=/usr/local/lib/ \
--with-debug-level=slowdebug \
--enable-ccache \
--enable-debug-symbols \
--with-target-bits=64 \
--with-jvm-variants=server \
OBJCOPY=gobjcopy
```

## 构建

输出结果

```plaintext
====================================================
A new configuration has been successfully created in
/Users/terwer/Documents/code/jdk/jdk8u/build/macosx-x86_64-normal-server-slowdebug
using configure arguments '--with-xcode-path=/Applications/Xcode_12.4.app --with-boot-jdk=/Library/Java/JavaVirtualMachines/jdk1.8.0_333.jdk/Contents/Home --with-freetype-include=/usr/local/include/freetype2 --with-freetype-lib=/usr/local/lib/ --with-debug-level=slowdebug --enable-ccache --enable-debug-symbols --with-target-bits=64 --with-jvm-variants=server OBJCOPY=gobjcopy'.

Configuration summary:
* Debug level:    slowdebug
* JDK variant:    normal
* JVM variants:   server
* OpenJDK target: OS: macosx, CPU architecture: x86, address length: 64

Tools summary:
* Boot JDK:       java version "1.8.0_333" Java(TM) SE Runtime Environment (build 1.8.0_333-b02) Java HotSpot(TM) 64-Bit Server VM (build 25.333-b02, mixed mode)  (at /Library/Java/JavaVirtualMachines/jdk1.8.0_333.jdk/Contents/Home)
* Toolchain:      clang (clang/LLVM)
* C Compiler:     Version 12.0.0 (at /usr/bin/clang)
* C++ Compiler:   Version 12.0.0 (at /usr/bin/clang++)

Build performance summary:
* Cores to use:   7
* Memory limit:   32768 MB
* ccache status:  disabled

➜  jdk8u git:(master)
```

修改一些配置：

```bash
export LC_ALL="en_US.UTF-8"


NEW_INCLUDE=/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1
export CFLAGS=-I$NEW_INCLUDE
export CXXFLAGS=-I$NEW_INCLUDE
```

### 编译

进入 jdk 目录 执行 make all 执行成功后会有如下输出，编译后 jdk 目录将近 3G 左右，编译的过程中存在很多的 Warning，直接忽略了。

make

```plaintext
make
```

结果输出

```bash
----- Build times --------------------------
Finished building OpenJDK for target 'default'
➜  jdk8u git:(master) ✗ 
```

### 查看 java -version

编译之后的 jdk 在这个目录下 `macosx-x86_64-normal-server-slowdebug`​

```plaintext
➜  jdk8u git:(master) ✗ ./build/macosx-x86_64-normal-server-slowdebug/jdk/bin/java -version
openjdk version "1.8.0_392-internal-debug"
OpenJDK Runtime Environment (build 1.8.0_392-internal-debug-terer_2023_09_19_18_36-b00)
OpenJDK 64-Bit Server VM (build 25.392-b00-debug, mixed mode)
➜  jdk8u git:(master) ✗ 
```

## 问题解决

1. 具体错误：

   ```
   configure: error: Xcode 6, 9-12 is required to build JDK 8, the version found was 15.0. Use --with-xcode-path to specify the location of Xcode or make Xcode active by using xcode-select.
   ```

   解决办法：

   安装 Xcode12，并设置

   ```
   --with-xcode-path=/Applications/Xcode_12.4.app
   ```
2. 具体错误：

   ```
   checking if we should generate debug symbols... configure: error: Unable to find objcopy, cannot enable debug-symbols
   ```

   解决方案：需要安装 `binutils`​​，并且需要在 `configure`​ ​时添加参数 `OBJCOPY`​​

   ```bash
   # 安装 binutilsbrew install binutils
   ```

   ```bash
   # configure 添加参数 OBJCOPY=gobjcopy
   ```

3. 具体错误：

   [https://github.com/akinomyoga/ble.sh/issues/190](https://github.com/akinomyoga/ble.sh/issues/190)

   解决方案

   安装 gawk

   ```bash
   brew install gawk
   ```

## 参考

[https://github.com/openjdk/jdk8u](https://github.com/openjdk/jdk8u)

[Mac 上编译 OpenJDK 过程记录](https://www.cnblogs.com/micrari/p/7018474.html)

[https://github.com/manheiba/jdk8mhb](https://github.com/manheiba/jdk8mhb)​

[《HotSpot 实战》](https://item.jd.com/11414422.html)

[MacOS 编译 openjdk8 并导入 Clion 调试](https://www.cnblogs.com/dwtfukgv/p/14727290.html)

[Mac10.14 下使用 Xcode10 编译调试 OpenJDK8 最新教程](https://blog.csdn.net/hilaryfrank/article/details/112859423)​

‍
