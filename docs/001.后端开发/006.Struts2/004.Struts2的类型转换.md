---
title: Struts2的类型转换
date: 2022-10-30 01:26:18
permalink: /post/struts2-type-conversion-pjcr7.html
meta:
  - name: keywords
    content: 使用 标签 注意 转换 struts struts2 taglib convert validate
  - name: description
    content: >-
      使用标签注意_struts使用标签库找不到uri_[strutstags]的taglib[s]问题解决新建loginjsp​文件内容如下_pageencoding=查看结果_​在action中使用actionsupport新增页面​loginjsp​pageencoding=​loginactionjava​packagespaceterwer_importorgapachecommonslangstringutils_importcomopensymphonyxworkactionsupport_pub
categories:
  - 默认分类
tags:
  - 使用
  - 标签
  - 注意
  - 转换
  - struts
  - struts2
  - taglib
  - convert
  - validate
author:
  name: terwer
  link: https://github.com/terwer
---


## 使用标签

注意：Struts2使用标签库找不到URI:[struts-tags]的taglib[s]问题解决[^1]

新建 `login2.jsp`​ 文件，内容如下：

```xml
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Struts2.3 Login2</title>
</head>
<body>
	<s:form action="login">
		<s:textfield name="username" label="username"></s:textfield>
		<s:textfield name="password" label="password"></s:textfield>
		<s:submit label="submit"></s:submit>
	</s:form>
</body>
</html>
```

查看结果：

![](https://img1.terwer.space/api/public/20221030150148.png)​

## 在 Action 中使用 ActionSupport

### 新增页面

​`login3.jsp`​

```xml
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Struts2.3 Login3</title>
</head>
<body>
	<s:form action="login3">
		<s:textfield name="username" label="username"></s:textfield>
		<s:textfield name="password" label="password"></s:textfield>
		<s:submit label="submit"></s:submit>
	</s:form>
</body>
</html>
```

​`LoginAction3.java`​

```java
package space.terwer;

import org.apache.commons.lang3.StringUtils;

import com.opensymphony.xwork2.ActionSupport;

public class LoginAction3 extends ActionSupport{
	private String username;
	private String password;

	public String getUsername() {
		return username;
	}

	public void setUsername(String username) {
		this.username = username;
	}

	public String getPassword() {
		return password;
	}

	public void setPassword(String password) {
		this.password = password;
	}

	@Override
	public void validate() {
		if(StringUtils.isBlank(this.getUsername())) {
			this.addFieldError("username", "username required");
		}
		if(StringUtils.isBlank(this.getPassword())) {
			this.addFieldError("password", "password required");
		}
	}

	public String execute() {
		return "success";
	}
}
```

### 修改 struts.xml 添加校验跳转 input

​`struts.xml`​

```xml
<!-- 使用ActionSupport -->
<action name="login3" class="space.terwer.LoginAction3">
	<result name="success">/result.jsp</result>
	<result name="input">/login3.jsp</result>
</action>
```

### 效果

![](https://img1.terwer.space/api/public/20221030152838.png)​

### 业务验证

在 `LoginAction2.java`​ 的 `execute()`​ 方法添加验证逻辑

```java
public String execute() {
	if("hello".equals(this.getUsername().trim()) && "world".equals(this.getPassword().trim())){
		return "success";
	}

	this.addFieldError("username", "username or password error");
	return "failer";
}
```

在 `struts.xml`​ 加入跳转逻辑

```xml
<!-- 使用ActionSupport -->
<action name="login3" class="space.terwer.LoginAction3">
	<result name="success">/result.jsp</result>
	<result name="input">/login3.jsp</result>
	<result name="failer">/login3.jsp</result>
</action>
```

效果

![](https://img1.terwer.space/api/public/20221030153959.png)​

注意：`result.jsp`​ 里面的两种写法等价。

```xml
username:${requestScope.username}<br /> 
password:${requestScope.password }
```

```xml
username:<%=request.getParameter("username") %><br /> 
password:<%=request.getParameter("password") %>
```

‍

[^1]: 

    找到 `struts2-core`​ 的 `jar`​ 包，将其复制到无关文件夹中，当作压缩文件解压，在其中的 `META-INF`​​ 目录中找到 `struts-tags.tld`​​ 文件，将其复制到项目中 `webapp/WEB-INF`​​ 目录下，然后在 `web.xml`​​ 文件中 （之前） 添加以下内容：

    ```xml
    <!--配置/struts-tag位置-->
    <jsp-config>
        <taglib>
            <taglib-uri>s</taglib-uri>
            <taglib-location>/WEB-INF/struts-tags.tld</taglib-location>
        </taglib>
    </jsp-config>
    ```
